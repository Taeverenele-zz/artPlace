<p id="notice"><%= notice %></p>

<div class="row">
  <div class="col-md-6">
    <%= image_tag 'homepage.jpg', class: 'img-fluid' %>
  </div>
  <div class="col-md-6">
    <p>
      <strong>Title:</strong>
      <%= @artwork.title %>
    </p>
    
    <p>
      <strong>Author:</strong>
      <%= @artwork.author %>
    </p>
    
    <p>
      <strong>Description:</strong>
      <%= @artwork.description %>
    </p>
    
    <p>
      <strong>Price:</strong>
      $<%= @artwork.price/100 %>
    </p>
    
    <p><button id="buynow-button">Buy Now!</button></p>

<script src="https://js.stripe.com/v3/"></script>

<script>
  const stripe = Stripe('<%= ENV['STRIPE_PUBLISHABLE_KEY'] %>');
  const buyButton = document.getElementById('buynow-button');
  buyButton.addEventListener('click', function() {
    fetch('<%= buy_path(@artwork.id) %>', { method: 'POST' })
    .then(function(response) {
      return response.json();
    })
    .then(function(session) {
      return stripe.redirectToCheckout({ sessionId: session.id })
    })
    .catch(function(error) {
      console.error('Error:', error);
    });
  })
</script>
  </div>
</div>


<%= link_to 'Edit', edit_artwork_path(@artwork) %> |
<%= link_to 'Back', artworks_path %>
